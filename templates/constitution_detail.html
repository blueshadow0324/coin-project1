{% extends "base.html" %}
{% block content %}
<h2>{{ const.title }}</h2>
<p>{{ const.content }}</p>

<hr>

{% if not expired_first %}
  <h4>🗳️ Första omröstningen (stänger {{ const.first_vote_deadline.strftime('%Y-%m-%d %H:%M') }})</h4>
  <form method="post">
    <input type="hidden" name="phase" value="first">
    <button name="vote" value="yes" class="btn btn-success">Ja</button>
    <button name="vote" value="no" class="btn btn-danger">Nej</button>
    <button name="vote" value="abstain" class="btn btn-secondary">Avstå</button>
  </form>

{% elif const.first_vote_passed and not expired_final %}
  <h4>🗳️ Slutomröstning (stänger {{ const.final_vote_deadline.strftime('%Y-%m-%d %H:%M') }})</h4>
  <form method="post">
    <input type="hidden" name="phase" value="final">
    <button name="vote" value="yes" class="btn btn-success">Ja</button>
    <button name="vote" value="no" class="btn btn-danger">Nej</button>
    <button name="vote" value="abstain" class="btn btn-secondary">Avstå</button>
  </form>

{% else %}
  <p class="text-danger"><strong>Omröstning avslutad.</strong></p>
{% endif %}

<hr>
<h5>Parti Röster</h5>
<ul>
  {% for v in votes %}
    <li>{{ v.party.name if v.party else 'Okänt parti' }} ({{ v.phase }}): {{ v.vote_choice|capitalize }}</li>
  {% endfor %}
</ul>
{% endblock %}
