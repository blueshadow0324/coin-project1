{% extends "base.html" %}
{% block content %}
<h2>{{ bill.title }}</h2>
<p>{{ bill.content }}</p>

<hr>

<h4>Live Röst Tabell</h4>
<div class="progress" style="height: 30px;">
  <div class="progress-bar bg-success" role="progressbar"
       style="width: {{ (yes_seats / total_seats) * 100 }}%"
       aria-valuenow="{{ yes_seats }}" aria-valuemin="0" aria-valuemax="{{ total_seats }}">
  </div>
  <div class="progress-bar bg-danger" role="progressbar"
       style="width: {{ (no_seats / total_seats) * 100 }}%"
       aria-valuenow="{{ no_seats }}" aria-valuemin="0" aria-valuemax="{{ total_seats }}">
  </div>
  <div class="progress-bar bg-secondary" role="progressbar"
       style="width: {{ (abstain_seats / total_seats) * 100 }}%"
       aria-valuenow="{{ abstain_seats }}" aria-valuemin="0" aria-valuemax="{{ total_seats }}">
  </div>
</div>

<!-- Labels under the bars -->
<div class="d-flex justify-content-between mt-1">
  <small class="text-success">YES {{ yes_seats }} seats</small>
  <small class="text-danger">NO {{ no_seats }} seats</small>
  <small class="text-secondary">Abstain {{ abstain_seats }} seats</small>
</div>

<p class="mt-2">
  Majority needed: {{ (total_seats // 2) + 1 }} seats
</p>

<hr>

{% if g.user and g.user.party %}
<form method="post">
  <button type="submit" name="vote" value="yes" class="btn btn-success">Rösta Ja</button>
  <button type="submit" name="vote" value="no" class="btn btn-danger">Rösta Nej</button>
  <button type="submit" name="vote" value="abstain" class="btn btn-secondary">Avstå</button>
</form>
{% else %}
<p><em>Bara användare som tillhör ett parti kan rösta.</em></p>
{% endif %}


<hr>

<p>
  Voting ends at: {{ bill.vote_deadline.strftime('%Y-%m-%d %H:%M UTC') }}<br>
  Time remaining: {{ ((bill.vote_deadline - now).total_seconds() // 3600) | int }} hours
</p>

<h5>Parti Röster</h5>
<ul>
  {% for v in votes %}
    <li>Party {{ v.party_id }} voted {{ v.vote_choice|capitalize }}</li>
  {% endfor %}
</ul>

{% endblock %}
